{% load static %}

<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta http-equiv="X-UA-Compatible" content="ie=edge"/>
    <link rel="icon" href="{% static 'img/fav-logo2.png' %}" type="image/x-icon" />
    
    <title>1GOV - BOLETIM DE PRODUÇÃO AMBULATORIAL</title>
    
    <link rel="stylesheet" href="{% static '@govbr-ds/core/dist/core.css' %}"/>
   
    <style>
        body {position: relative; font-family: Arial, sans-serif; margin: 0; padding: 0; border-left: 1px solid var(--gray-20); border-right: 1px solid var(--gray-20);}
        .header {top: 0; left: 0; right: 0; z-index: 1000; border-bottom: 1px solid var(--gray-20); border-top: 1px solid var(--gray-20); text-align: center; padding: 0px !important;}
        .header .row {display: flex; align-items: center; justify-content: space-between;}
        
        .divider-text {position: relative; padding-top: 20px; border: 1px solid var(--gray-20);}
        .divider-text::after {position: absolute; top: 0; left: 35px; background: white; padding: 0 20px; margin-top: -10px; color: #333333;}
        .divider-text-dados-operacionais::after {content: "Dados Operacionais";}
        .divider-text-responsavel::after {content: "Responsável pelo estabelecimento";}
        .divider-text-gestor::after {content: "Gestor Municipal/Estadual";}
        
        table {width: 88%; margin: 0 auto; table-layout: fixed; border-collapse: collapse;}
        th {background-color: #fff; padding-bottom: 8px !important; color: #636262 !important; font-size: 14px !important;}
        td {padding-top: 5px !important; font-size: 13px !important;}
        th, td {padding: 2px; text-align: start !important; border: 0px solid #fff !important;}
        
        @page {@bottom-center {content: element(footer);}}
        @page {size: 260mm 297mm; margin: 10mm;}
        .page-break {page-break-before: always;}

        .hr-title{ border: 1px solid var(--gray-20); width:100%; }
        .container {margin-top: 20px;}
        .fixed-footer {
            position: fixed;
            left: 0;
            bottom: 0;
            width: 100%;
            z-index: 1000;
            padding: 10px 0;
            border-bottom: 1px solid var(--gray-20) !important;
            border-left: 1px solid var(--gray-20) !important;
            border-right: 1px solid var(--gray-20) !important;
        }
    </style>
</head>
<body>
    {% for page in paginated_data %}
        <div class="header fixed-header">
            <div class="row">
                <div class="col-3 mt-3 m-3">
                    <img class="logo" src="{% static 'img/logo_sus.png' %}" style="width: 130px" alt="Logo"/>
                </div>
                <div class="col-9 text-center">
                    <h3 class="mt-3">
                        <b>BPA-C BOLETIM DE PRODUÇÃO AMBULATORIAL</b> <br/>
                        <b>DADOS CONSOLIDADOS</b> 
                    </h3>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row" style="width:90%; margin:0 auto;">
                <div class="col-4 text-center">
                    <span><b>Dados Operacionais</b></span>
                </div>
                <div class="col-8">
                    <hr class="hr-title">
                </div>
            </div>

            <div class="row" style="width:90%; margin:0 auto;">
                <div class="col-4" style="text-align:right;">
                    <p style="color: #636262 !important">Estabelecimento de Saúde:</p>
                </div>
                <div class="col-4">
                    <span class="pl-2"><b>{{unidade_saude.nome|default:'-----'}}</b></span>
                </div>

                <div class="col-2" style="text-align:right;">
                    <p style="color: #636262 !important">Mês/Ano:</p>
                </div>
                <div class="col-2">
                    <span class="pl-2"><b>{{mes_ano_selecionado}}</b></span>
                </div>
            </div>

            <div class="row" style="width:90%; margin:0 auto;">
                <div class="col-4" style="text-align:right;">
                    <p style="color: #636262 !important">CNES:</p>
                </div>
                <div class="col-4">
                    <span class="pl-2"><b>{{unidade_saude.cnes|default:'-----'}}</b></span>
                </div>

                <div class="col-2" style="text-align:right;">
                    <p style="color: #636262 !important">Folha:</p>
                </div>
                <div class="col-2">
                    <span class="pl-2"><b>{{page.pagina}}</b></span>
                </div>
            </div>
            <div class="row" style="width:90%; margin:0 auto;">
                <div class="col-4" style="text-align:right;">
                    <p style="color: #636262 !important">UF:</p>
                </div>
                <div class="col">
                    <span class="pl-2"><b>{{unidade_saude.municipio.estado.sigla}}</b></span>
                </div>
            </div>

            <div class="row" style="width:90%; display: flex;">
                <div class="col-4 text-center">
                    <span><b>Atendimentos Realizados</b></span>
                </div>
                <div class="col-8 text-center">
                    <hr class="hr-title">
                </div>
            </div>

            <table class="mt-1">
                <thead>
                    <tr>
                        <th style="width:10%; text-align: start !important;">Procedimento</th>
                        <th style="width:50%;">Descrição</th>
                        <th style="width:10%; text-align: center !important;">CBO</th>
                        <th style="width:5%; text-align: center !important;">Idade</th>
                        <th style="width:10%; text-align: center !important;">Quantidade</th>
                    </tr>
                </thead>
                <tbody>
                    {% if page.objects %}
                        {% for procedimento in page.objects %}
                            <tr class="pt-4">
                                <td><b>{{procedimento.codigo}}</b></td>
                                <td style="padding: 1px !important;">{{procedimento.nome}}</td>
                                <td style="text-align: center !important;">{{procedimento.cbo}}</td>
                                <td style="text-align: center !important; padding-left: 6px !important;">{{procedimento.idade}}</td>
                                <td style="text-align: start !important; padding-left: 20px !important;">{{procedimento.quantidade}}</td>
                            </tr>
                        {% endfor %}
                        <tr>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td style="text-align: center !important;"><b>Total:</b></td>
                            <td style="text-align: start !important; padding-left: 20px !important; font-size: 14px !important;"><b>{{page.total_geral}}</b></td>
                        </tr>
                    {% else %}
                        <tr>
                            <td class="p-4 text-center" colspan="4">Nenhuma informação encontrada nesta pesquisa.</td>
                        </tr>
                    {% endif %}
                </tbody>
            </table>
        </div>

        <div class="page-break"></div>

    {% endfor %}

    <div class="fixed-footer">
        <div class="row p-2">
            <div class="col-6 p-1">
                <div class="container divider-text divider-text-responsavel title-hr box-card-border mt-4">
                    <div class="row">
                        <div class="col-12 text-center pb-5">
                            <span class="mt-2">Assinatura Digital</span>
                            <div style="padding: 17px;"></div>
                        </div>
                        <div class="col-12">
                            <span class="mt-2">Data: {{data_atual}}</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-6 p-1">
                <div class="container divider-text divider-text-gestor title-hr box-card-border mt-4">
                    <div class="row">
                        <div class="col-12 text-center pb-5">
                            <span class="mt-2">Assinatura Digital</span>
                            <div style="padding: 17px;"></div>
                        </div>
                        <div class="col-12">
                            <span class="mt-2">Data: {{data_atual}}</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</body>
</html>
